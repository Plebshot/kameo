---
title: 监督概述
---

监督是构建弹性演员系统的一个关键概念，确保系统能够从失败中恢复并继续无间断地运行。在Kameo中，通过可定制的行为钩子和演员链接的组合，促进了监督和演员生命周期管理。本页面讨论如何有效利用这些功能来创建健壮的演员层次结构，并优雅地管理演员失败。

### 自定义演员在恐慌时的行为

当一个演员发生恐慌时，可以使用`Actor`特性中的`on_panic`钩子自定义其默认行为。这个钩子允许开发者定义在演员遇到恐慌时应执行的自定义逻辑，提供了管理意外失败的第一道防线。

### 链接演员

除了个别演员的行为之外，Kameo支持将演员链接在一起，创建一个监督树。这种结构使得演员能够监控彼此的健康状况并响应失败，形成一个自愈系统的骨干。

#### 演员链接

可以使用两种主要方法链接演员，这些方法建立了父子和兄弟关系：

- `ActorRef::link_child`
- `ActorRef::link_together`

#### 处理链接失败

当一个链接的演员死亡时，幸存的演员可以使用`Actor`特性中的`on_link_died`钩子来响应这一事件。这个钩子提供了已故演员的ID和其终止的原因，使幸存的演员能够实施自定义逻辑，例如重启失败的演员或采取其他补救措施。

对于`on_link_died`的默认行为是，如果链接的演员由于非正常关闭的任何原因死亡，当前演员将停止。这种保守的默认设置确保不会默默忽略失败，通过防止依赖的演员在不一致的状态下继续运行，促进系统稳定。

#### 解除演员链接

在某些情况下，可能需要移除演员之间的链接，无论是为了重构监督树，还是响应应用程序动态的变化。Kameo为此目的提供了方法：

- `ActorRef::unlink_child`：移除父演员与其子演员之间的链接。
- `ActorRef::unlink_together`：移除兄弟演员之间的链接。

这些方法允许对演员监督层次结构进行动态调整，确保系统能够适应新的要求或通过重新组织演员关系从错误中恢复。

---

#### 总结

Kameo中的监督是构建弹性、自愈演员系统的强大机制。通过利用可定制的恐慌行为和演员链接，开发者可以设计出能够从失败中恢复的系统，通过中断保持一致的操作。无论是通过父子层次结构还是同辈关系，Kameo中的演员链接为健壮的监督策略提供了基础，确保演员系统能够优雅地处理并从它们面临的不可避免的挑战中恢复过来。